<!doctype html>
<html lang="es">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="icon" type="image/x-icon" href="favicon.ico" />
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
		<link rel="stylesheet" href="./css/estilo.css?v=7">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
		<title>Inventario de equipo</title>
	</head>
	<body class="fondo-gris-1">

		<div class="container-fluid fondo-verde-2">
			<nav class="container-xxl">
				<div class="row">
					<div class="col-8">
						<a class="cabecera-logo" href="index.html">
							<img src="./img/site_logo.jpg" class="img-fluid" alt="Logo Agrokasa">
						</a>
					</div>
					<div class="col-4">
						<div class="cabecera-boton text-end">
							<button id="boton-cerrar-sesion" type="button" class="btn btn-danger btn-sm" onclick="cerrarSesion()">
								<i class="bi bi-x me-1" aria-hidden="true"></i>Cerrar sesión
							</button>
						</div>
					</div>
				</div>
			</nav>
		</div>

		<div class="container-fluid py-5 fondo-blanco">
			<nav class="container-xxl">
				<div class="row">
					<div class="col-12">
						<h3 class="mt-2 mb-5 text-center color-verde-1"><b>Inventario de Equipo</b></h3>
					</div>
				</div>	

				<div id="seccion-buscar" class="row">
					<div class="col-8 col-md-9 col-lg-10 col-xl-10 form-group">
						<input type="text" id="input-busqueda" class="form-control form-control-sm" placeholder="Búsqueda">
					</div>
					<div class="col-4 col-md-3 col-lg-2 col-xl-2 form-group">
						<div class="d-grid gap-2">
							<button id="boton-buscar" type="button" class="btn btn-primary btn-sm" onclick="buscar()">
								<i class="bi bi-search me-1" aria-hidden="true"></i>Buscar
							</button>
						</div>
					</div>
				</div>	

				<div class="row">
					<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group seccion-filtrar">
						<label for="filtro-proveedor" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Proveedor</label>
						<select id="filtro-proveedor" class="form-select form-select-sm" aria-label="Proveedor">
							<option value="" selected>Selecciona la empresa</option>
						</select>
					</div>
					<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group seccion-filtrar">
						<label for="filtro-operador" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Operador</label>
						<select id="filtro-operador" class="form-select form-select-sm" aria-label="Operador">
							<option value="" selected>Selecciona el operador</option>
						</select>
					</div>
					<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group seccion-filtrar">
						<label for="filtro-usuario" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Usuario</label>
						<select id="filtro-usuario" class="form-select form-select-sm" aria-label="Usuario" onchange="traerFiltroUsuario()">
							<option value="" selected>Selecciona el usuario</option>
						</select>
					</div>
					<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group seccion-filtrar">
						<label for="filtro-sede" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Sede</label>
						<select id="filtro-sede" class="form-select form-select-sm" aria-label="Sede">
							<option value="" selected>Selecciona el sede</option>
						</select>
					</div>
					<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group seccion-filtrar">
						<label for="filtro-area" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Área</label>
						<select id="filtro-area" class="form-select form-select-sm" aria-label="Área">
							<option value="" selected>Selecciona el area</option>
						</select>
					</div>
					<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group seccion-filtrar">
						<label for="filtro-equipo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Equipo</label>
						<select id="filtro-equipo" class="form-select form-select-sm" aria-label="Equipo">
							<option value="" selected>Selecciona la fecha</option>
						</select>
					</div>
				</div>
				<br>
				<div class="row mb-5">
					<div class="col-12 form-group text-end">
						<button type="button" class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#nuevo">
							<i class="bi bi-plus-circle me-1" aria-hidden="true"></i>Nuevo
						</button>
						<button id="boton-descargar-buscar" type="button" class="btn btn-secondary btn-sm" onclick="descargarBuscar()">
							<i class="bi bi-file-earmark-excel me-1" aria-hidden="true"></i>Descargar
						</button>
						<button id="boton-descargar-filtrar" type="button" class="btn btn-secondary btn-sm" onclick="descargarFiltrar()">
							<i class="bi bi-file-earmark-excel me-1" aria-hidden="true"></i>Descargar
						</button>
						<button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#subir">
							<i class="bi bi-file-earmark-excel me-1" aria-hidden="true"></i>Subir
						</button>
						<button id="boton-filtrar" type="button" class="btn btn-primary btn-sm" onclick="filtrar()">
							<i class="bi bi-funnel me-1" aria-hidden="true"></i>Filtrar
						</button>
						<button id="boton-ver-buscar" type="button" class="btn btn-primary btn-sm" onclick="verBuscar()">
							<i class="bi bi-three-dots-vertical me-1" aria-hidden="true"></i> 
							<i class="bi bi-search me-1" aria-hidden="true"></i>
						</button>
						<button id="boton-ver-filtrar" type="button" class="btn btn-primary btn-sm" onclick="verFiltrar()">
							<i class="bi bi-three-dots-vertical me-1" aria-hidden="true"></i> 
							<i class="bi bi-funnel me-1" aria-hidden="true"></i>
						</button>
					</div>
				</div>

				<div id="listado-inventario"></div>

				<nav id="paginacion"></nav>
			</div>
		</div>

		<footer class="pie fondo-gris-1 py-4">
			<div class="container-xxl">
				<div class="row">
					<div class="col-md-12">
						<a class="pie-logo" href="index.html">
							<img src="./img/site_logo.jpg" class="img-fluid" alt="Logo Agrokasa">
						</a>
					</div>
				</div>
			</div>
		</footer>
				
		<div id="spinner-div">
			<div class="spinner-border text-light" role="status"></div>
		</div>

		<div class="modal fade" id="nuevo" tabindex="-1" aria-labelledby="nuevoLabel" aria-hidden="true">
			<div class="modal-dialog modal-xl">
				<div class="modal-content bordes-redondos">
					<div class="modal-header">
						<h5 class="modal-title color-verde-1" id="nuevoLabel"><b>Nuevo</b></h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">

						<div class="row">
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-proveedor-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Proveedor</label>
								<input id="input-proveedor-nuevo" type="text" class="form-control form-control-sm" placeholder="Proveedor">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-operador-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Operador</label>
								<input id="input-operador-nuevo" type="text" class="form-control form-control-sm" placeholder="Operador">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-codigo_empleado-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Código empleado</label>
								<input id="input-codigo_empleado-nuevo" type="text" class="form-control form-control-sm" placeholder="Código empleado">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-usuario-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Usuario</label>
								<input id="input-usuario-nuevo" type="text" class="form-control form-control-sm" placeholder="Usuario">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-ceco-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Ceco</label>
								<input id="input-ceco-nuevo" type="text" class="form-control form-control-sm" placeholder="Ceco">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-linea-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Línea</label>
								<input id="input-linea-nuevo" type="text" class="form-control form-control-sm" placeholder="Línea">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-costo_plan_sin_igv-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Costo plan sin IGV</label>
								<input id="input-costo_plan_sin_igv-nuevo" type="text" class="form-control form-control-sm" placeholder="Costo plan sin IGV">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-costo_plan_con_igv-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Costo plan con IGV</label>
								<input id="input-costo_plan_con_igv-nuevo" type="text" class="form-control form-control-sm" placeholder="Costo plan con IGV">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-sede-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Sede</label>
								<input id="input-sede-nuevo" type="text" class="form-control form-control-sm" placeholder="Sede">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-area-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Área</label>
								<input id="input-area-nuevo" type="text" class="form-control form-control-sm" placeholder="Área">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-fecha_compra_inicial-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Fecha compra inicial</label>
								<input id="input-fecha_compra_inicial-nuevo" type="text" class="form-control form-control-sm" placeholder="dd/mm/aaaa">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-fecha_ultimo_cambio-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Fecha último cambio</label>
								<input id="input-fecha_ultimo_cambio-nuevo" type="text" class="form-control form-control-sm" placeholder="dd/mm/aaaa">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-plazo_permanencia-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Plazo permanencia</label>
								<input id="input-plazo_permanencia-nuevo" type="text" class="form-control form-control-sm" placeholder="Plazo permanencia">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-codigo_equipo-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Código equipo</label>
								<input id="input-codigo_equipo-nuevo" type="text" class="form-control form-control-sm" placeholder="Código equipo">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-tipo_equipo-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Tipo equipo</label>
								<input id="input-tipo_equipo-nuevo" type="text" class="form-control form-control-sm" placeholder="Tipo equipo">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-marca-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Marca</label>
								<input id="input-marca-nuevo" type="text" class="form-control form-control-sm" placeholder="Marca">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-modelo-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Modelo</label>
								<input id="input-modelo-nuevo" type="text" class="form-control form-control-sm" placeholder="Modelo">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-equipo-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Equipo</label>
								<input id="input-equipo-nuevo" type="text" class="form-control form-control-sm" placeholder="Equipo">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-imei-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">IMEI</label>
								<input id="input-imei-nuevo" type="text" class="form-control form-control-sm" placeholder="IMEI">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-mac_address-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">MAC Address</label>
								<input id="input-mac_address-nuevo" type="text" class="form-control form-control-sm" placeholder="MAC Address">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-numero_sim-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Número SIM</label>
								<input id="input-numero_sim-nuevo" type="text" class="form-control form-control-sm" placeholder="Número SIM">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-plan_contratado-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Plan contratado</label>
								<input id="input-plan_contratado-nuevo" type="text" class="form-control form-control-sm" placeholder="Plan contratado">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-estado_equipo-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Estado equipo</label>
								<input id="input-estado_equipo-nuevo" type="text" class="form-control form-control-sm" placeholder="Estado equipo">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-renovacion_por-nuevo" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Renovación por</label>
								<input id="input-renovacion_por-nuevo" type="text" class="form-control form-control-sm" placeholder="Renovación por">
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button id="boton-cerrar-nuevo" type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
							<i class="bi bi-x me-1" aria-hidden="true"></i>Cerrar
						</button>
						<button type="button" class="btn btn-primary btn-sm" onclick="guardarNuevo()">
							<i class="bi bi-save me-1" aria-hidden="true"></i>Guardar
						</button>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="editar" tabindex="-1" aria-labelledby="editarLabel" aria-hidden="true">
			<div class="modal-dialog modal-xl">
				<div class="modal-content bordes-redondos">
					<div class="modal-header">
						<h5 class="modal-title color-verde-1" id="editarLabel"><b>Editar</b></h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<div class="row">
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-proveedor-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Proveedor</label>
								<input id="input-proveedor-editar" type="text" class="form-control form-control-sm" placeholder="Proveedor">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-operador-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Operador</label>
								<input id="input-operador-editar" type="text" class="form-control form-control-sm" placeholder="Operador">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-codigo_empleado-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Código empleado</label>
								<input id="input-codigo_empleado-editar" type="text" class="form-control form-control-sm" placeholder="Código empleado">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-usuario-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Usuario</label>
								<input id="input-usuario-editar" type="text" class="form-control form-control-sm" placeholder="Usuario">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-ceco-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Ceco</label>
								<input id="input-ceco-editar" type="text" class="form-control form-control-sm" placeholder="Ceco">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-linea-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Línea</label>
								<input id="input-linea-editar" type="text" class="form-control form-control-sm" placeholder="Línea">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-costo_plan_sin_igv-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Costo plan sin IGV</label>
								<input id="input-costo_plan_sin_igv-editar" type="text" class="form-control form-control-sm" placeholder="Costo plan sin IGV">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-costo_plan_con_igv-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Costo plan con IGV</label>
								<input id="input-costo_plan_con_igv-editar" type="text" class="form-control form-control-sm" placeholder="Costo plan con IGV">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-sede-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Sede</label>
								<input id="input-sede-editar" type="text" class="form-control form-control-sm" placeholder="Sede">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-area-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Área</label>
								<input id="input-area-editar" type="text" class="form-control form-control-sm" placeholder="Área">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-fecha_compra_inicial-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Fecha compra inicial</label>
								<input id="input-fecha_compra_inicial-editar" type="text" class="form-control form-control-sm" placeholder="dd/mm/aaaa">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-fecha_ultimo_cambio-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Fecha último cambio</label>
								<input id="input-fecha_ultimo_cambio-editar" type="text" class="form-control form-control-sm" placeholder="dd/mm/aaaa">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-plazo_permanencia-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Plazo permanencia</label>
								<input id="input-plazo_permanencia-editar" type="text" class="form-control form-control-sm" placeholder="Plazo permanencia">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-codigo_equipo-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Código equipo</label>
								<input id="input-codigo_equipo-editar" type="text" class="form-control form-control-sm" placeholder="Código equipo">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-tipo_equipo-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Tipo equipo</label>
								<input id="input-tipo_equipo-editar" type="text" class="form-control form-control-sm" placeholder="Tipo equipo">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-marca-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Marca</label>
								<input id="input-marca-editar" type="text" class="form-control form-control-sm" placeholder="Marca">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-modelo-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Modelo</label>
								<input id="input-modelo-editar" type="text" class="form-control form-control-sm" placeholder="Modelo">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-equipo-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Equipo</label>
								<input id="input-equipo-editar" type="text" class="form-control form-control-sm" placeholder="Equipo">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-imei-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">IMEI</label>
								<input id="input-imei-editar" type="text" class="form-control form-control-sm" placeholder="IMEI">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-mac_address-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">MAC Address</label>
								<input id="input-mac_address-editar" type="text" class="form-control form-control-sm" placeholder="MAC Address">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-numero_sim-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Número SIM</label>
								<input id="input-numero_sim-editar" type="text" class="form-control form-control-sm" placeholder="Número SIM">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-plan_contratado-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Plan contratado</label>
								<input id="input-plan_contratado-editar" type="text" class="form-control form-control-sm" placeholder="Plan contratado">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-estado_equipo-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Estado equipo</label>
								<input id="input-estado_equipo-editar" type="text" class="form-control form-control-sm" placeholder="Estado equipo">
							</div>
							<div class="col-12 col-md-6 col-lg-4 col-xl-4 mb-3 form-group">
								<label for="input-renovacion_por-editar" class="col-form-label col-form-label-sm py-0 color-gris-2 texto-chico">Renovación por</label>
								<input id="input-renovacion_por-editar" type="text" class="form-control form-control-sm" placeholder="Renovación por">
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button id="boton-cerrar-editar" type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
							<i class="bi bi-x me-1" aria-hidden="true"></i>Cerrar
						</button>
						<button type="button" class="btn btn-primary btn-sm" onclick="guardarEditar()">
							<i class="bi bi-save me-1" aria-hidden="true"></i>Guardar
						</button>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="eliminar" tabindex="-1" aria-labelledby="eliminarLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content bordes-redondos">
					<div class="modal-header">
						<h5 class="modal-title color-verde-1" id="eliminarLabel"><b>Eliminar</b></h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<div class="row">
							<div class="col-12 my-4">
								<h6 class="text-center">¿Está seguro de eliminar este registro?</h6>
								<input type="hidden" name="index-eliminar" id="index-eliminar" value="">
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button id="boton-cerrar-eliminar" type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
							<i class="bi bi-x me-1" aria-hidden="true"></i>Cerrar
						</button>
						<button type="button" class="btn btn-danger btn-sm" onclick="guardarEliminar()">
							<i class="bi bi-trash" aria-hidden="true"></i> Eliminar
						</button>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="subir" tabindex="-1" aria-labelledby="subirLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content bordes-redondos">
					<div class="modal-header">
						<h5 class="modal-title color-verde-1" id="subirLabel"><b>Subir</b></h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">

						<div class="row">
							<div class="col-12">
								<input class="form-control form-control-sm"" type="file" id="uploadFile" accept=".xls,.xlsx"  >
							</div>		
						</div>

					</div>
					<div class="modal-footer">
						<button id="boton-cerrar-subir" type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
							<i class="bi bi-x me-1" aria-hidden="true"></i>Cerrar
						</button>
						<button id="subirInventario" type="button" class="btn btn-danger btn-sm">
							<i class="bi bi-cloud-arrow-up" aria-hidden="true"></i> subir
						</button>
					</div>
				</div>
			</div>
		</div>
	</body>

	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
	<script>

		const info = {
			direccion: 'https://localhost:7039/api/Inventario'
		}
		let respuesta;
		let paginaActual = 1;
		let porPagina = 20;
		let cantidadPaginas;
		let limites;
		let botonBuscar = true;
		let botonFiltrar = false;

		$( document ).ready(function() {
			console.log(window.localStorage.getItem('logueado'));
			//if (window.localStorage.getItem('logueado') == true) {
				//$('#contenedor').load('parts/inventario.html?v=3');
				traerFiltrosIniciales();
			/*} else {
				$('#contenedor').load('parts/logueo.html?v=3');
			}*/
		});

		function cerrarSesion() {
			$('#spinner-div').show();
			window.localStorage.setItem('logueado', false);
			console.log(window.localStorage.getItem('logueado'));
			window.location.href = 'index.html';
			//$('#contenedor').load('parts/logueo.html?v=3');
			$('#spinner-div').hide();
		}

		function verFiltrar() {
			botonFiltrar = true;
			
			$('.seccion-filtrar').show();
			$('#boton-filtrar').show();
			$('#boton-descargar-filtrar').show();
			$('#boton-ver-buscar').show();
			
			$('#seccion-buscar').hide();
			$('#boton-buscar').hide();
			$('#boton-descargar-buscar').hide();
			$('#boton-ver-filtrar').hide();
		}

		function verBuscar() {
			botonBuscar = true;
			
			$('#seccion-buscar').show();
			$('#boton-buscar').show();
			$('#boton-descargar-buscar').show();
			$('#boton-ver-filtrar').show();
			
			$('.seccion-filtrar').hide();
			$('#boton-filtrar').hide();
			$('#boton-descargar-filtrar').hide();
			$('#boton-ver-buscar').hide();
		}

		function traerFiltrosIniciales() {
			$('#spinner-div').show();
			$.ajax({
				url: info.direccion + '/ObtenerFiltroOperador',
				type: 'POST',
				data: JSON.stringify(),
				contentType: 'application/json; charset=utf-8',
				dataType: 'json',
				error: function (error) {
					console.log(error);
				},
				success: function (data) {
					let cadena = '<option value="" selected>Selecciona el operador</option>';
					for (let i = 0; i < data.length; i++) {
						cadena += '<option value="' + data[i].operador + '">' + data[i].operador + '</option>';							
					}
					$('#filtro-operador').html(cadena);
				}
			});
			$.ajax({
				url: info.direccion + '/ObtenerFiltroUsuario',
				type: 'POST',
				data: JSON.stringify(),
				contentType: 'application/json; charset=utf-8',
				dataType: 'json',
				error: function (error) {
					console.log(error);
				},
				success: function (data) {
					let cadena = '<option value="" selected>Selecciona el usuario</option>';
					for (let i = 0; i < data.length; i++) {
						cadena += '<option value="' + data[i].usuario + '">' + data[i].usuario + '</option>';							
					}
					$('#filtro-usuario').html(cadena);
				}
			});
			$.ajax({
				url: info.direccion + '/ObtenerFiltroSede',
				type: 'POST',
				data: JSON.stringify(),
				contentType: 'application/json; charset=utf-8',
				dataType: 'json',
				error: function (error) {
					console.log(error);
				},
				success: function (data) {
					let cadena = '<option value="" selected>Selecciona la sede</option>';
					for (let i = 0; i < data.length; i++) {
						cadena += '<option value="' + data[i].sede + '">' + data[i].sede + '</option>';							
					}
					$('#filtro-sede').html(cadena);
				}
			});
			$.ajax({
				url: info.direccion + '/ObtenerFiltroArea',
				type: 'POST',
				data: JSON.stringify(),
				contentType: 'application/json; charset=utf-8',
				dataType: 'json',
				error: function (error) {
					console.log(error);
				},
				success: function (data) {
					let cadena = '<option value="" selected>Selecciona el área</option>';
					for (let i = 0; i < data.length; i++) {
						cadena += '<option value="' + data[i].area + '">' + data[i].area + '</option>';							
					}
					$('#filtro-area').html(cadena);
				}
			});
			$.ajax({
				url: info.direccion + '/ObtenerFiltroProveedor',
				type: 'POST',
				data: JSON.stringify(),
				contentType: 'application/json; charset=utf-8',
				dataType: 'json',
				error: function (error) {
					console.log(error);
				},
				success: function (data) {
					let cadena = '<option value="" selected>Selecciona la opción</option>';
					for (let i = 0; i < data.length; i++) {
						cadena += '<option value="' + data[i].proveedor + '">' + data[i].proveedor + '</option>';							
					}
					$('#filtro-proveedor').html(cadena);
				}
			});
			$.ajax({
				url: info.direccion + '/ObtenerFiltroEquipo',
				type: 'POST',
				data: JSON.stringify(),
				contentType: 'application/json; charset=utf-8',
				dataType: 'json',
				error: function (error) {
					console.log(error);
				},
				success: function (data) {
					let cadena = '<option value="" selected>Selecciona la opción</option>';
					for (let i = 0; i < data.length; i++) {
						cadena += '<option value="' + data[i].equipo + '">' + data[i].equipo + '</option>';							
					}
					$('#filtro-equipo').html(cadena);
				},
				complete: function () {
					$('#spinner-div').hide();
				}
			});
		}

		function eliminar(i) {
			$('#index-eliminar').val(i);
		}

		function guardarEliminar() {
			let i = $('#index-eliminar').val();
			let eliminar = {
				id: $('#' + i + '-id').val()
			};

			$.ajax({
				url: info.direccion + '/EliminarRegistro',
				type: 'POST',
				data: JSON.stringify(eliminar),
				contentType: 'application/json; charset=utf-8',
				dataType: 'json',
				error: function (error) {
					console.log(error);
				},
				success: function (data) {
					console.log(data);				
				},
				complete: function () {
					//alert('Registro eliminado correctamente.');
					$('#boton-cerrar-eliminar').click();
					if (botonBuscar) $('#boton-buscar').click();
					if (botonFiltrar) $('#boton-filtrar').click();
					$('#spinner-div').hide();
				}
			});
		}

		function buscar() {
			$('#spinner-div').show();
			let busqueda = {
				palabra: $('#input-busqueda').val(),
			};
			$.ajax({
				url: info.direccion + '/BuscarInventario',
				type: 'POST',
				data: JSON.stringify(busqueda),
				contentType: 'application/json; charset=utf-8',
				dataType: 'json',
				error: function (error) {
					console.log(error);
				},
				success: function (data) {
					respuesta = data;
					paginaActual = 1;
					armarRespuesta();
				},
				complete: function () {
					$('#spinner-div').hide();
				}
			});
		}

		function filtrar() {
			$('#spinner-div').show();
			let filtro = {
				operador: $('#filtro-operador').val(),
				usuario: $('#filtro-usuario').val(),
				sede: $('#filtro-sede').val(),
				area: $('#filtro-area').val(),
				proveedor: $('#filtro-proveedor').val(),
				equipo: $('#filtro-equipo').val(),
			};
			$.ajax({
				url: info.direccion + '/FiltrarInventario',
				type: 'POST',
				data: JSON.stringify(filtro),
				contentType: 'application/json; charset=utf-8',
				dataType: 'json',
				error: function (error) {
					console.log(error);
				},
				success: function (data) {
					respuesta = data;
					paginaActual = 1;
					armarRespuesta();
				},
				complete: function () {
					$('#spinner-div').hide();
				}
			});
		}

		function descargarBuscar() {
			$('#spinner-div').show();
			let busqueda = {
				palabra: $('#input-busqueda').val(),
			};
			$.ajax({
				url: info.direccion + '/DescargarBuscarInventario',
				type: 'POST',
				data: JSON.stringify(busqueda),
				contentType: 'application/json; charset=utf-8',
				dataType: 'binary',
				cache: false,
				xhrFields : {
					'responseType' : 'blob'
				},
                xhr: function () {
                    let xhr = new XMLHttpRequest();
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 2) {
                            if (xhr.status == 200) {
                                xhr.responseType = "blob";
                            } else {
                                xhr.responseType = "text";
                            }
                        }
                    };
                    return xhr;
                },
				error: function (error) {
					console.log(error);
				},
                success: function (data) {
					let fileName = 'ReporteInventario.xlsx'
                    let blob = new Blob([data], { type: "application/octetstream" }); 
                    let isIE = false || !!document.documentMode;
                    if (isIE) {
                        window.navigator.msSaveBlob(blob, fileName);
                    } else {
                        let url = window.URL || window.webkitURL;
                        link = url.createObjectURL(blob);
                        let a = $("<a />");
                        a.attr("download", fileName);
                        a.attr("href", link);
                        $("body").append(a);
                        a[0].click();
                        $("body").remove(a);
                    }
                },
				complete: function () {
					$('#spinner-div').hide();
				}
			});
		}

		function descargarFiltrar() {
			$('#spinner-div').show();
			let filtro = {
				operador: $('#filtro-operador').val(),
				usuario: $('#filtro-usuario').val(),
				sede: $('#filtro-sede').val(),
				area: $('#filtro-area').val(),
				proveedor: $('#filtro-proveedor').val(),
				equipo: $('#filtro-equipo').val(),
			};
			$.ajax({
				url: info.direccion + '/DescargarFiltrarInventario',
				type: 'POST',
				data: JSON.stringify(filtro),
				contentType: 'application/json; charset=utf-8',
				dataType: 'binary',
				cache: false,
				xhrFields : {
					'responseType' : 'blob'
				},
                xhr: function () {
                    let xhr = new XMLHttpRequest();
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 2) {
                            if (xhr.status == 200) {
                                xhr.responseType = "blob";
                            } else {
                                xhr.responseType = "text";
                            }
                        }
                    };
                    return xhr;
                },
				error: function (error) {
					console.log(error);
				},
                success: function (data) {
					let fileName = 'ReporteInventario.xlsx'
                    let blob = new Blob([data], { type: "application/octetstream" }); 
                    let isIE = false || !!document.documentMode;
                    if (isIE) {
                        window.navigator.msSaveBlob(blob, fileName);
                    } else {
                        let url = window.URL || window.webkitURL;
                        link = url.createObjectURL(blob);
                        let a = $("<a />");
                        a.attr("download", fileName);
                        a.attr("href", link);
                        $("body").append(a);
                        a[0].click();
                        $("body").remove(a);
                    }
                },
				complete: function () {
					$('#spinner-div').hide();
				}
			});
		}

		function armarRespuesta() {			
			let longitud = respuesta.length;
			cantidadPaginas = obtenerCantidadPaginas(longitud, porPagina);
			limites = obtenerLimites(longitud, paginaActual, cantidadPaginas, porPagina);
			
			let cadena;
			if(longitud > 0) {
				cadena = '<div class="table-responsive">' +
					'<table class="table table-striped table-hover table-sm table-bordered">' +
						'<thead>' +
							'<tr>' +
								'<th class="color-verde-1"> </th>' +
								'<th class="color-verde-1">Proveedor</th>' +
								'<th class="color-verde-1">Operador</th>' +
								'<th class="color-verde-1">Código empleado</th>' +
								'<th class="color-verde-1">Usuario</th>' +
								'<th class="color-verde-1">Ceco</th>' +
								'<th class="color-verde-1">Línea</th>' +
								'<th class="color-verde-1">Costo plan sin IGV</th>' +
								'<th class="color-verde-1">Costo plan con IGV</th>' +
								'<th class="color-verde-1">Sede</th>' +
								'<th class="color-verde-1">Área</th>' +
								'<th class="color-verde-1">Fecha compra inicial</th>' +
								'<th class="color-verde-1">Fecha último cambio</th>' +
								'<th class="color-verde-1">Plazo permanencia</th>' +
								'<th class="color-verde-1">Meses transcurridos</th>' +
								'<th class="color-verde-1">Meses faltantes</th>' +
								'<th class="color-verde-1">Código equipo</th>' +
								'<th class="color-verde-1">Tipo equipo</th>' +
								'<th class="color-verde-1">Marca</th>' +
								'<th class="color-verde-1">Modelo</th>' +
								'<th class="color-verde-1">Equipo</th>' +
								'<th class="color-verde-1">IMEI</th>' +
								'<th class="color-verde-1">MAC Address</th>' +
								'<th class="color-verde-1">Número SIM</th>' +
								'<th class="color-verde-1">Plan contratado</th>' +
								'<th class="color-verde-1">Estado equipo</th>' +
								'<th class="color-verde-1">Renovación por</th>' +
							'</tr>' +
						'</thead>' +
						'<tbody>';

				for (let i = limites[0]; i < limites[1]; i++) {
					cadena += '<tr>' +
						'<td class="text-center">' +
							'<button type="button" class="btn btn-success btn-sm mb-1" onclick="editar(' + i + ')"  data-bs-toggle="modal" data-bs-target="#editar">' +
								'<i class="bi bi-pencil" aria-hidden="true"></i>' +
							'</button>' +
							'<button type="button" class="btn btn-danger btn-sm" onclick="eliminar(' + i + ')"  data-bs-toggle="modal" data-bs-target="#eliminar">' +
								'<i class="bi bi-trash" aria-hidden="true"></i>' +
							'</button>' +
						'</td>' +
						'<input id="' + i + '-id" type="hidden" value="'+ respuesta[i].id + '"/>'+
						'<td><div id="' + i + '-proveedor">' + respuesta[i].proveedor + '</div></td>' +
						'<td><div id="' + i + '-operador">' + respuesta[i].operador + '</div></td>' +
						'<td><div id="' + i + '-codigo_empleado">' + respuesta[i].codigo_empleado + '</div></td>' +
						'<td><div id="' + i + '-usuario">' + respuesta[i].usuario + '</div></td>' +
						'<td><div id="' + i + '-ceco">' + respuesta[i].ceco + '</div></td>' +
						'<td><div id="' + i + '-linea">' + respuesta[i].linea + '</div></td>' +
						'<td><div id="' + i + '-costo_plan_sin_igv">' + respuesta[i].costo_plan_sin_igv + '</div></td>' +
						'<td><div id="' + i + '-costo_plan_con_igv">' + respuesta[i].costo_plan_con_igv + '</div></td>' +
						'<td><div id="' + i + '-sede">' + respuesta[i].sede + '</div></td>' +
						'<td><div id="' + i + '-area">' + respuesta[i].area + '</div></td>' +
						'<td><div id="' + i + '-fecha_compra_inicial">' + formatoFechaWeb(respuesta[i].fecha_compra_inicial) + '</div></td>' +
						'<td><div id="' + i + '-fecha_ultimo_cambio">' + formatoFechaWeb(respuesta[i].fecha_ultimo_cambio) + '</div></td>' +
						'<td><div id="' + i + '-plazo_permanencia">' + respuesta[i].plazo_permanencia + '</div></td>' +
						'<td><div id="' + i + '-meses_transcurridos">' + respuesta[i].meses_transcurridos + '</div></td>' +
						'<td><div id="' + i + '-meses_faltantes">' + respuesta[i].meses_faltantes + '</div></td>' +
						'<td><div id="' + i + '-codigo_equipo">' + respuesta[i].codigo_equipo + '</div></td>' +
						'<td><div id="' + i + '-tipo_equipo">' + respuesta[i].tipo_equipo + '</div></td>' +
						'<td><div id="' + i + '-marca">' + respuesta[i].marca + '</div></td>' +
						'<td><div id="' + i + '-modelo">' + respuesta[i].modelo + '</div></td>' +
						'<td><div id="' + i + '-equipo">' + respuesta[i].equipo + '</div></td>' +
						'<td><div id="' + i + '-imei">' + respuesta[i].imei + '</div></td>' +
						'<td><div id="' + i + '-mac_address">' + respuesta[i].mac_address + '</div></td>' +
						'<td><div id="' + i + '-numero_sim">' + respuesta[i].numero_sim + '</div></td>' +
						'<td><div id="' + i + '-plan_contratado">' + respuesta[i].plan_contratado + '</div></td>' +
						'<td><div id="' + i + '-estado_equipo">' + respuesta[i].estado_equipo + '</div></td>' +
						'<td><div id="' + i + '-renovacion_por">' + respuesta[i].renovacion_por + '</div></td>' +
					'</tr>';															
				}
				cadena += '</tbody>' +
					'</table>' +
				'</div>';
			} else {
				cadena = '<div class="table-responsive">' +
					'<table class="table table-striped table-hover table-sm table-bordered">' +
						'<thead>' +
							'<tr>' +
								'<th class="text-center color-verde-1">SIN REGISTROS</th>' +
							'</tr>' +
						'</thead>' +
					'</table>' +
				'</div>';														
			}
			armarPaginacion();
			$('#listado-inventario').html(cadena);
		}

		function armarPaginacion() {
			let cadena = '<ul class="pagination pagination-sm">';

			/*let limiteInicio = 1;
			if ((porPagina/2) <= limiteInicio) limiteInicio = paginaActual;
			if ((porPagina/2) <= paginaActual) limiteInicio++;
			let limiteFin = limiteInicio + 5;*/
		
			//for (let i = limiteInicio; i <= limiteFin; i++) {	
			for (let i = 1; i <= cantidadPaginas; i++) {
				if (i <= 40) {
					if (paginaActual == i){			
						cadena += '<li id="pagina-' + i + '" class="page-item active">'+
							'<span class="page-link fondo-verde-2 borde-verde-2">' + i + '</span>'+
						'</li>';
					} else {
						cadena += '<li id="pagina-' + i + '" class="page-item">'+
							'<a class="page-link color-gris-3" onclick="navegarPagina(' + i + ')" href="#">' + i + '</a>'+
						'</li>';
					}
				}
			}
			cadena += '</ul>';
			$('#paginacion').html(cadena);
		}

		function navegarPagina(i) {
			paginaActual = i;
			armarRespuesta();
		}

		function guardarNuevo() {
			var nuevo = {
				proveedor: $('#input-proveedor-nuevo').val(),
				operador: $('#input-operador-nuevo').val(),
				codigo_empleado: $('#input-codigo_empleado-nuevo').val(),
				usuario: $('#input-usuario-nuevo').val(),
				ceco: $('#input-ceco-nuevo').val(),
				linea: $('#input-linea-nuevo').val(),
				costo_plan_sin_igv: $('#input-costo_plan_sin_igv-nuevo').val(),
				costo_plan_con_igv: $('#input-costo_plan_con_igv-nuevo').val(),
				sede: $('#input-sede-nuevo').val(),
				area: $('#input-area-nuevo').val(),
				fecha_compra_inicial: formatoFechaBD($('#input-fecha_compra_inicial-nuevo').val()),
				fecha_ultimo_cambio: formatoFechaBD($('#input-fecha_ultimo_cambio-nuevo').val()),
				plazo_permanencia: parseInt($('#input-plazo_permanencia-nuevo').val()),
				codigo_equipo: $('#input-codigo_equipo-nuevo').val(),
				tipo_equipo: $('#input-tipo_equipo-nuevo').val(),
				marca: $('#input-marca-nuevo').val(),
				modelo: $('#input-modelo-nuevo').val(),
				equipo: $('#input-equipo-nuevo').val(),
				imei: $('#input-imei-nuevo').val(),
				mac_address: $('#input-mac_address-nuevo').val(),
				numero_sim: $('#input-numero_sim-nuevo').val(),
				plan_contratado: $('#input-plan_contratado-nuevo').val(),
				estado_equipo: $('#input-estado_equipo-nuevo').val(),
				renovacion_por: $('#input-renovacion_por-nuevo').val(),
			};

			if (nuevo.proveedor == '' 
				|| nuevo.operador == '') {			
				alert('Es necesario llenar todos los campos.');
			
			} else {
				$.ajax({
					url: info.direccion + '/NuevoRegistro',
					type: 'POST',
					data: JSON.stringify(nuevo),
					contentType: 'application/json; charset=utf-8',
					dataType: 'json',
					error: function (error) {
						console.log(error);
					},
					success: function (data) {
						alert('Registro nuevo realizado correctamente.');
					},
					complete: function () {	
						$('#boton-cerrar-nuevo').click();
						if (botonBuscar) $('#boton-buscar').click();
						if (botonFiltrar) $('#boton-filtrar').click();

						$('#input-proveedor-nuevo').val('');
						$('#input-operador-nuevo').val('');
						$('#input-codigo_empleado-nuevo').val('');
						$('#input-usuario-nuevo').val('');
						$('#input-ceco-nuevo').val('');
						$('#input-linea-nuevo').val('');
						$('#input-costo_plan_sin_igv-nuevo').val('');
						$('#input-costo_plan_con_igv-nuevo').val('');
						$('#input-sede-nuevo').val('');
						$('#input-area-nuevo').val('');
						$('#input-fecha_compra_inicial-nuevo').val('');
						$('#input-fecha_ultimo_cambio-nuevo').val('');
						$('#input-plazo_permanencia-nuevo').val('');
						$('#input-codigo_equipo-nuevo').val('');
						$('#input-tipo_equipo-nuevo').val('');
						$('#input-marca-nuevo').val('');
						$('#input-modelo-nuevo').val('');
						$('#input-equipo-nuevo').val('');
						$('#input-imei-nuevo').val('');
						$('#input-mac_address-nuevo').val('');
						$('#input-numero_sim-nuevo').val('');
						$('#input-plan_contratado-nuevo').val('');
						$('#input-estado_equipo-nuevo').val('');
						$('#input-renovacion_por-nuevo').val('');

						$('#spinner-div').hide();
					}
				});
			}
		}

		let idEditar;
		function editar(i) {
			let dataEditar = {
				proveedor: $('#' + i + '-proveedor').text(),
				operador: $('#' + i + '-operador').text(),
				codigo_empleado: $('#' + i + '-codigo_empleado').text(),
				usuario: $('#' + i + '-usuario').text(),
				ceco: $('#' + i + '-ceco').text(),
				linea: $('#' + i + '-linea').text(),
				costo_plan_sin_igv: $('#' + i + '-costo_plan_sin_igv').text(),
				costo_plan_con_igv: $('#' + i + '-costo_plan_con_igv').text(),
				sede: $('#' + i + '-sede').text(),
				area: $('#' + i + '-area').text(),
				fecha_compra_inicial: $('#' + i + '-fecha_compra_inicial').text(),
				fecha_ultimo_cambio: $('#' + i + '-fecha_ultimo_cambio').text(),
				plazo_permanencia: $('#' + i + '-plazo_permanencia').text(),
				codigo_equipo: $('#' + i + '-codigo_equipo').text(),
				tipo_equipo: $('#' + i + '-tipo_equipo').text(),
				marca: $('#' + i + '-marca').text(),
				modelo: $('#' + i + '-modelo').text(),
				equipo: $('#' + i + '-equipo').text(),
				imei: $('#' + i + '-imei').text(),
				mac_address: $('#' + i + '-mac_address').text(),
				numero_sim: $('#' + i + '-numero_sim').text(),
				plan_contratado: $('#' + i + '-plan_contratado').text(),
				estado_equipo: $('#' + i + '-estado_equipo').text(),
				renovacion_por: $('#' + i + '-renovacion_por').text(),
			};
			//indiceEditar = i;

			idEditar = parseInt($('#' + i + '-id').val());

			//alert(parseInt($('#' + i + '-id').val()));

			$('#input-proveedor-editar').val(dataEditar.proveedor);
			$('#input-operador-editar').val(dataEditar.operador);
			$('#input-codigo_empleado-editar').val(dataEditar.codigo_empleado);
			$('#input-usuario-editar').val(dataEditar.usuario);
			$('#input-ceco-editar').val(dataEditar.ceco);
			$('#input-linea-editar').val(dataEditar.linea);
			$('#input-costo_plan_sin_igv-editar').val(dataEditar.costo_plan_sin_igv);
			$('#input-costo_plan_con_igv-editar').val(dataEditar.costo_plan_con_igv);
			$('#input-sede-editar').val(dataEditar.sede);
			$('#input-area-editar').val(dataEditar.area);
			$('#input-fecha_compra_inicial-editar').val(dataEditar.fecha_compra_inicial);
			$('#input-fecha_ultimo_cambio-editar').val(dataEditar.fecha_ultimo_cambio);
			$('#input-plazo_permanencia-editar').val(dataEditar.plazo_permanencia);
			$('#input-codigo_equipo-editar').val(dataEditar.codigo_equipo);
			$('#input-tipo_equipo-editar').val(dataEditar.tipo_equipo);
			$('#input-marca-editar').val(dataEditar.marca);
			$('#input-modelo-editar').val(dataEditar.modelo);
			$('#input-equipo-editar').val(dataEditar.equipo);
			$('#input-imei-editar').val(dataEditar.imei);
			$('#input-mac_address-editar').val(dataEditar.mac_address);
			$('#input-numero_sim-editar').val(dataEditar.numero_sim);
			$('#input-plan_contratado-editar').val(dataEditar.plan_contratado);
			$('#input-estado_equipo-editar').val(dataEditar.estado_equipo);
			$('#input-renovacion_por-editar').val(dataEditar.renovacion_por);
		}
		
		function guardarEditar() {
			var editar = {
				id: idEditar,
				proveedor: $('#input-proveedor-editar').val(),
				operador: $('#input-operador-editar').val(),
				codigo_empleado: $('#input-codigo_empleado-editar').val(),
				usuario: $('#input-usuario-editar').val(),
				ceco: $('#input-ceco-editar').val(),
				linea: $('#input-linea-editar').val(),
				costo_plan_sin_igv: $('#input-costo_plan_sin_igv-editar').val(),
				costo_plan_con_igv: $('#input-costo_plan_con_igv-editar').val(),
				sede: $('#input-sede-editar').val(),
				area: $('#input-area-editar').val(),
				fecha_compra_inicial: formatoFechaBD($('#input-fecha_compra_inicial-editar').val()),
				fecha_ultimo_cambio: formatoFechaBD($('#input-fecha_ultimo_cambio-editar').val()),
				plazo_permanencia: parseInt($('#input-plazo_permanencia-editar').val()),
				codigo_equipo: $('#input-codigo_equipo-editar').val(),
				tipo_equipo: $('#input-tipo_equipo-editar').val(),
				marca: $('#input-marca-editar').val(),
				modelo: $('#input-modelo-editar').val(),
				equipo: $('#input-equipo-editar').val(),
				imei: $('#input-imei-editar').val(),
				mac_address: $('#input-mac_address-editar').val(),
				numero_sim: $('#input-numero_sim-editar').val(),
				plan_contratado: $('#input-plan_contratado-editar').val(),
				estado_equipo: $('#input-estado_equipo-editar').val(),
				renovacion_por: $('#input-renovacion_por-editar').val(),
			};

			if (editar.proveedor == '' 
				|| editar.operador == '') {			
				alert('Es necesario llenar todos los campos.');
			
			} else {
				$.ajax({
					url: info.direccion + '/EditarRegistro',
					type: 'POST',
					data: JSON.stringify(editar),
					contentType: 'application/json; charset=utf-8',
					dataType: 'json',
					error: function (error) {
						console.log(error);
					},
					success: function (data) {
						alert('Registro editado realizado correctamente.');
					},
					complete: function () {	
						$('#boton-cerrar-editar').click();
						if (botonBuscar) $('#boton-buscar').click();
						if (botonFiltrar) $('#boton-filtrar').click();

						$('#input-proveedor-editar').val('');
						$('#input-operador-editar').val('');
						$('#input-codigo_empleado-editar').val('');
						$('#input-usuario-editar').val('');
						$('#input-ceco-editar').val('');
						$('#input-linea-editar').val('');
						$('#input-costo_plan_sin_igv-editar').val('');
						$('#input-costo_plan_con_igv-editar').val('');
						$('#input-sede-editar').val('');
						$('#input-area-editar').val('');
						$('#input-fecha_compra_inicial-editar').val('');
						$('#input-fecha_ultimo_cambio-editar').val('');
						$('#input-plazo_permanencia-editar').val('');
						$('#input-codigo_equipo-editar').val('');
						$('#input-tipo_equipo-editar').val('');
						$('#input-marca-editar').val('');
						$('#input-modelo-editar').val('');
						$('#input-equipo-editar').val('');
						$('#input-imei-editar').val('');
						$('#input-mac_address-editar').val('');
						$('#input-numero_sim-editar').val('');
						$('#input-plan_contratado-editar').val('');
						$('#input-estado_equipo-editar').val('');
						$('#input-renovacion_por-editar').val('');

						$('#spinner-div').hide();
					}
				});
			}
		}


		let uploadedFile;
		let fileData=[{}];

		$('#uploadFile').on('change', () => {
			uploadedFile = event.target.files[0];
		});

		$('#subirInventario').on('click', () => {
			XLSX.utils.json_to_sheet(fileData, 'output.xlsx');
			if (uploadedFile) {
				let fileReader = new FileReader();
				fileReader.readAsBinaryString(uploadedFile);
				fileReader.onload = (event) => {
					let fileData = event.target.result;
					let workbook = XLSX.read(fileData,{type:'binary'});
					workbook.SheetNames.forEach(sheet => {
						let rowData = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheet]);
						for (let i = 0; i < rowData.length; i++) {
							rowData[i].fecha_compra_inicial = formatoFechaBD(rowData[i].fecha_compra_inicial);
							rowData[i].fecha_ultimo_cambio = formatoFechaBD(rowData[i].fecha_ultimo_cambio);
							rowData[i].plazo_permanencia = parseInt(rowData[i].plazo_permanencia);
						}
						let jsonData = JSON.stringify(rowData,undefined,4);
						subir(jsonData);
					});
				}
			}
		});

		/*document.getElementById('uploadFile').addEventListener('change', (event) => {
			uploadedFile = event.target.files[0];
		});
		
		document.getElementById('subirInventario').addEventListener('click', () => {
			XLSX.utils.json_to_sheet(fileData, 'output.xlsx');
			if (uploadedFile) {
				let fileReader = new FileReader();
				fileReader.readAsBinaryString(uploadedFile);
				fileReader.onload = (event) => {
					let fileData = event.target.result;
					let workbook = XLSX.read(fileData,{type:'binary'});
					workbook.SheetNames.forEach(sheet => {
						let rowData = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheet]);
						for (let i = 0; i < rowData.length; i++) {
							rowData[i].fecha_compra_inicial = formatoFechaBD(rowData[i].fecha_compra_inicial);
							rowData[i].fecha_ultimo_cambio = formatoFechaBD(rowData[i].fecha_ultimo_cambio);
							rowData[i].plazo_permanencia = parseInt(rowData[i].plazo_permanencia);
						}
						let jsonData = JSON.stringify(rowData,undefined,4);
						subir(jsonData);
					});
				}
			}
		});*/

		function subir(json) {
			$('#spinner-div').show();
			$.ajax({
				url: info.direccion + '/SubirInventario',
				type: 'POST',
				data: json,
				contentType: 'application/json; charset=utf-8',
				dataType: 'json',
				error: function (error) {
					console.log(error);
				},
				success: function (data) {
					console.log(data);
				},
				complete: function () {
					alert('Inventario subido correctamente.');
					$('#boton-cerrar-subir').click();
					if (botonBuscar) $('#boton-buscar').click();
					if (botonFiltrar) $('#boton-filtrar').click();
					$('#spinner-div').hide();
				}
			});
		}

		function obtenerCantidadPaginas(longitud, porPagina) {
			let resultado = longitud / porPagina;
			let cantidadPaginas = Math.ceil(resultado);

			console.log('obtenerCantidadPaginas');
			console.log(cantidadPaginas);
			return cantidadPaginas;
		}

		function obtenerLimites(longitud, numeroPagina, cantidadPaginas, porPagina) {
			let maximo;
			let modulo = longitud % porPagina;
			let limiteInferior = numeroPagina * porPagina - porPagina;
			let limiteSuperior = numeroPagina * porPagina;
			(modulo == 0)
				? maximo = cantidadPaginas * porPagina
				: maximo = cantidadPaginas * porPagina - porPagina;
			if (limiteSuperior > maximo && modulo > 0) {
			limiteSuperior = limiteInferior + modulo;
			}
			let resultado = [limiteInferior, limiteSuperior];
			console.log('obtenerLimites');
			console.log(resultado);

			return resultado;
		}

	</script>
	<script src="js/formats.js?v=3"></script>
</html>